<!-- 
  Main layout container. 
  CSS class applied based on auth status:
  - 'aitema-main-layout': Authenticated users with sidebar.
  - 'aitema-main-layout--anonymous': Public pages, no sidebar.
-->
<div 
  class="aitema-main-layout" 
  [class.aitema-main-layout--anonymous]="!authService.isAuthenticated()">

  <!-- Sidebar: Authenticated users only -->
  @if (authService.isAuthenticated()) {
    <aside class="aitema-sidebar">
      <div class="sidebar-header">
        <a routerLink="/dashboard" class="aitema-logo-badge sidebar-logo" aria-label="Zur Dashboard-Startseite">
          aitema|Hinweis
        </a>
      </div>

      <nav class="sidebar-nav" aria-label="Hauptnavigation">
        <a routerLink="/dashboard" routerLinkActive="active" class="sidebar-nav-item">
          <span class="sidebar-nav-icon" aria-hidden="true">&#9632;</span>
          <span>Dashboard</span>
        </a>
        <a routerLink="/meldungen" routerLinkActive="active" class="sidebar-nav-item">
          <span class="sidebar-nav-icon" aria-hidden="true">&#128065;</span>
          <span>Alle Meldungen</span>
        </a>
        <a routerLink="/admin" routerLinkActive="active" class="sidebar-nav-item">
          <span class="sidebar-nav-icon" aria-hidden="true">&#9881;</span>
          <span>Administration</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        @if(authService.currentUser(); as user) {
          <div class="sidebar-user">
            <div class="sidebar-user-avatar" aria-hidden="true">
              {{ user.firstName?.charAt(0) }}{{ user.lastName?.charAt(0) }}
            </div>
            <div class="sidebar-user-info">
              <span class="sidebar-user-name">{{ user.firstName }} {{ user.lastName }}</span>
              <span class="sidebar-user-email">{{ user.email }}</span>
            </div>
          </div>
        }
        <button (click)="authService.logout()" class="aitema-button aitema-button--ghost sidebar-logout-btn">
          Abmelden
        </button>
      </div>
    </aside>
  }

  <!-- Main Content Wrapper -->
  <div class="aitema-content-wrap">
    <header class="aitema-top-nav" role="banner">
      @if (!authService.isAuthenticated()) {
        <!-- Anonymous: Logo left -->
        <div class="anon-nav-brand">
          <a routerLink="/" class="aitema-logo-badge" aria-label="aitema|Hinweis â€” Zur Startseite">
            aitema|Hinweis
          </a>
        </div>

        <!-- Anonymous: Center nav links -->
        <nav class="anon-nav-links" aria-label="Seitennavigation">
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="anon-nav-link">
            Startseite
          </a>
          <a routerLink="/status" routerLinkActive="active" class="anon-nav-link">
            Status pr&uuml;fen
          </a>
          <a routerLink="/login" routerLinkActive="active" class="anon-nav-link">
            Mitarbeiter
          </a>
        </nav>
      }

      <!-- Nav Actions -->
      <div class="navbar-actions">
        <hw-language-switcher />
        @if (!authService.isAuthenticated()) {
          <a routerLink="/" class="anon-cta-btn">
            &#128274; Jetzt melden
          </a>
        }
      </div>
    </header>

    <main class="aitema-main-content" id="main-content" tabindex="-1">
      <router-outlet />
    </main>
  </div>
</div>

<!-- Accessibility Skip Link -->
<a href="#main-content" class="sr-only sr-only-focusable">Zum Hauptinhalt springen</a>
